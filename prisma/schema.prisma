// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model User {
  id          Int       @id @default(autoincrement())
  name        String
  ratings     Rating[]
  asPlayerOne Match[]   @relation(name: "playerOne")
  asPlayerTwo Match[]   @relation(name: "playerTwo")
}

model Game {
  id      Int      @id @default(autoincrement())
  name    String
  ladders Ladder[]
}

model Ladder {
  id               Int       @id @default(autoincrement())
  name             String    @unique
  game             Game      @relation(fields: [gameId], references: [id])
  gameId           Int
  eloRating        Float
  glickoRating     Float
  glickoDeviation  Float
  glickoTau        Float
  glickoVolatility Float
  ratings          Rating[]
  matches          Match[]
}

model Rating {
  id               Int    @id @default(autoincrement())
  user             User   @relation(fields: [userId], references: [id])
  userId           Int
  ladder           Ladder @relation(fields: [ladderId], references: [id])
  ladderId         Int
  eloRating        Float
  eloK             Int
  glickoRating     Float
  glickoDeviation  Float
  glickoVolatility Float
}

model Match {
  id          Int    @id @default(autoincrement())
  ladder      Ladder @relation(fields: [ladderId], references: [id])
  ladderId    Int
  playerOne   User   @relation("playerOne", fields: [playerOneId], references: [id])
  playerOneId Int
  playerTwo   User   @relation("playerTwo", fields: [playerTwoId], references: [id])
  playerTwoId Int
}
